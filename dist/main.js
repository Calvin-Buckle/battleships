(()=>{"use strict";const e=class{constructor(e,t){this.hits=[],this.size=e,this.id=t}hit(e){return this.hits.push(e)}isSunk(){return this.position.every((e=>this.hits.includes(e)))}isHit(){return this.hits.some((e=>this.position.includes(e)))}},t={Carrier:new e(5,"Carrier"),BattleShip:new e(4,"BattleShip"),Cruiser:new e(3,"Cruiser"),Submarine:new e(3,"Submarine"),Destroyer:new e(2,"Destroyer"),EnemyCarrier:new e(5),EnemyBattleShip:new e(4),EnemyCruiser:new e(3),EnemySubmarine:new e(3),EnemyDestroyer:new e(2)};document.addEventListener("gameboardReady",(()=>{document.getElementById("playerBoard");let e,s,r,i,n,l=document.querySelectorAll(".ship"),a=document.querySelectorAll(".block");l.forEach((e=>{e.addEventListener("click",(()=>{"column"!==e.style.flexDirection?e.style.flexDirection="column":e.style.flexDirection="row"}))})),l.forEach((e=>{e.addEventListener("dragstart",(()=>{"column"===e.style.flexDirection&&(i="column")}))})),document.addEventListener("dragstart",(t=>{e=t.target.getAttribute("Id")})),a.forEach((n=>{n.addEventListener("dragover",(a=>{if(a.preventDefault(),s=t[e].size,l=t.shipId,!r){let e=n;for(let t=0;t<s;t++)if("column"===i){for(let t=0;t<10;t++)e=e.nextElementSibling;e.classList.add("hovered")}else e.classList.add("hovered"),e=e.nextElementSibling;r=!0}}))})),a.forEach((e=>{e.addEventListener("dragleave",(()=>{r=!1;let t=e;for(let e=0;e<s;e++)if("column"===i)for(let e=0;e<10;e++)t.classList.remove("hovered"),t=t.nextElementSibling;else t.classList.remove("hovered"),t=t.nextElementSibling}))})),a.forEach((r=>{r.addEventListener("drop",(()=>{if(s=t[e].size,t[e]){n=t[e].id;let i=r;for(let e=0;e<s;e++)i.classList.add("selected"),i.classList.add(n),i.classList.remove("hovered"),i=i.nextElementSibling;const l=document.getElementById(n);l&&(l.style.display="none")}else console.error("Invalid shipId:",e)}))})),document.getElementById("reset").addEventListener("click",(()=>{document.querySelectorAll(".ship").forEach((e=>{e.style.display="flex"}))}))})),document.addEventListener("gameboardReady",(()=>{let e=document.getElementById("start"),s=document.getElementById("reset"),r=document.getElementById("enemyBoard"),i=document.getElementById("playerBoard");function n(){return Math.floor(100*Math.random())+0}function l(e){let s=r.firstElementChild,i=n();for(let e=0;e<i;e++)s=s.nextElementSibling;let a=function(e,s){let r;for(let i=0;i<t[e].size;i++){if(s.classList.contains("selected")){r=!1;break}if(!s.nextElementSibling){r=!1;break}for(let e=0;e<10;e++){if(!s.nextElementSibling){r=!1;break}s=s.nextElementSibling,r=!0}}return r}(e,s);if(a)for(let r=0;r<t[e].size&&(s.classList.add("selected"),s.classList.add(e),r!=t[e].size-1);r++)for(let e=0;e<10;e++)s=s.nextElementSibling;else l(e)}function a(e){let s=n(),i=r.firstElementChild;for(let e=0;e<s;e++)i=i.nextElementSibling;let l=function(e,s,r){let i=!0;for(let r=0;r<t[e].size;r++){if(s.classList.contains("selected")){i=!1;break}let e=Array.from(s.classList),t=s.nextElementSibling;if(!t){i=!1;break}{let n=Array.from(t.classList);if(e[r]!==n[r]){i=!1;break}s=t}}return i}(e,i);if(l)for(let s=0;s<t[e].size;s++)i.classList.add("selected"),i.classList.add(e),i=i.nextElementSibling;else a(e)}function o(e){"horizontal"===function(){let e;return e=Math.floor(100*Math.random())+0<=50?"vertical":"horizontal",e}()?a(e):l(e)}s.addEventListener("click",(()=>{i.querySelectorAll(".block").forEach((e=>{e.classList.remove("selected"),e.classList.remove("missed"),e.classList.remove("hit"),e.classList.remove("Destroyed"),e.classList.remove("Carrier"),e.classList.remove("Submarine"),e.classList.remove("Destroyer"),e.classList.remove("Cruiser"),e.classList.remove("BattleShip")})),r.querySelectorAll("div").forEach((e=>{e.classList.remove("selected"),e.classList.remove("missed"),e.classList.remove("hit"),e.classList.remove("Destroyed"),e.classList.remove("EnemyCarrier"),e.classList.remove("EnemySubmarine"),e.classList.remove("EnemyDestroyer"),e.classList.remove("EnemyCruiser"),e.classList.remove("EnemyBattleShip")}))})),e.addEventListener("click",(()=>{o("EnemyCarrier"),setTimeout(o("EnemyBattleShip"),10),setTimeout(o("EnemyCruiser"),10),setTimeout(o("EnemySubmarine"),10),setTimeout(o("EnemyDestroyer"),10)}))})),document.addEventListener("gameboardReady",(()=>{!function(){let e,t,s,r=document.getElementById("enemyBoard"),i=document.getElementById("playerBoard"),n=document.querySelectorAll(".eBlock"),l=(document.querySelectorAll(".block"),document.getElementById("start")),a=0,o=0,c={Carrier:0,BattleShip:0,Cruiser:0,Submarine:0,Destroyer:0,EnemyCarrier:0,EnemyBattleShip:0,EnemyCruiser:0,EnemySubmarine:0,EnemyDestroyer:0};function m(){let e=Math.floor(100*Math.random())+0,t=i.firstElementChild;for(let s=0;s<e;s++)console.log(1),t=t.nextElementSibling;t.classList.contains("hit")||t.classList.contains("missed")?m():function(e){e.classList.contains("selected")?(e.classList.add("hit"),d(e)):e.classList.add("missed"),s=!1,u(c)}(t)}function d(e){e.classList.contains("Carrier")&&c.Carrier++,e.classList.contains("BattleShip")&&c.BattleShip++,e.classList.contains("Cruiser")&&c.Cruiser++,e.classList.contains("Submarine")&&c.Submarine++,e.classList.contains("Destroyer")&&c.Destroyer++,e.classList.contains("EnemyCarrier")&&c.EnemyCarrier++,e.classList.contains("EnemyBattleShip")&&c.EnemyBattleShip++,e.classList.contains("EnemyCruiser")&&c.EnemyCruiser++,e.classList.contains("EnemySubmarine")&&c.EnemySubmarine++,e.classList.contains("EnemyDestroyer")&&c.EnemyDestroyer++}function u(e){5===e.Carrier&&(E("Carrier"),e.Carrier=0),4===e.BattleShip&&(E("BattleShip"),e.BattleShip=0),3===e.Cruiser&&(E("Cruiser"),e.Cruiser=0),3===e.Submarine&&(E("Submarine"),e.Submarine=0),2===e.Destroyer&&(E("Destroyer"),e.Destroyer=0),5==e.EnemyCarrier&&(y("EnemyCarrier"),e.EnemyCarrier=0),4==e.EnemyBattleShip&&(y("EnemyBattleShip"),e.EnemyBattleShip=0),3==e.EnemyCruiser&&(y("EnemyCruiser"),e.EnemyCruiser=0),3==e.EnemySubmarine&&(y("EnemySubmarine"),e.EnemySubmarine=0),2==e.EnemyDestroyer&&(y("EnemyDestroyer"),e.EnemyDestroyer=0)}function y(e){o++,5==o&&alert("PLAYER WINS"),t=r.firstElementChild;for(let s=0;s<100;s++)t.classList.contains(e)&&(t.classList.remove(e),t.classList.remove("selected"),t.classList.remove("hit"),t.classList.add("Destroyed")),t=t.nextElementSibling}function E(t){a++,5==a&&alert("AI WINS"),e=i.firstElementChild;for(let s=0;s<100;s++)e.classList.contains(t)&&(e.classList.remove(t),e.classList.remove("selected"),e.classList.remove("hit"),e.classList.add("Destroyed")),e=e.nextElementSibling}l.addEventListener("click",(()=>{s=!1})),s&&setTimeout(m,1e3),n.forEach((t=>{t.addEventListener("click",(()=>{s||t.classList.contains("hit")||t.classList.contains("missed")||(s=!0,setTimeout(m,750),t.classList.contains("selected")?(t.classList.add("hit"),e=t,d(e)):t.classList.add("missed"),u(c))}))}))}()})),new class{constructor(){this.board=this.generateDomBoard(),document.dispatchEvent(new Event("gameboardReady"))}generateDomBoard(){let e=document.getElementById("playerBoard"),t=document.getElementById("enemyBoard");for(let s=0;s<10;s++)for(let r=0;r<10;r++){let r=document.createElement("div"),i=document.createElement("div");e.appendChild(r),t.appendChild(i),r.classList="block",i.classList="eBlock";let n=this.zoneName(s);r.classList.add(n),i.classList.add(n)}}zoneName(e){let t;return 0==e&&(t="A"),1==e&&(t="B"),2==e&&(t="C"),3==e&&(t="D"),4==e&&(t="E"),5==e&&(t="F"),6==e&&(t="G"),7==e&&(t="H"),8==e&&(t="I"),9==e&&(t="J"),t}}})();