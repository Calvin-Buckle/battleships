(()=>{"use strict";const e=class{constructor(e,t){this.hits=[],this.size=e,this.id=t}hit(e){return this.hits.push(e)}isSunk(){return this.position.every((e=>this.hits.includes(e)))}isHit(){return this.hits.some((e=>this.position.includes(e)))}},t={Carrier:new e(5,"Carrier"),BattleShip:new e(4,"BattleShip"),Cruiser:new e(3,"Cruiser"),Submarine:new e(3,"Submarine"),Destroyer:new e(2,"Destroyer"),EnemyCarrier:new e(5),EnemyBattleShip:new e(4),EnemyCruiser:new e(3),EnemySubmarine:new e(3),EnemyDestroyer:new e(2)};document.addEventListener("gameboardReady",(()=>{document.getElementById("playerBoard");let e,s,n,i,l,r=document.querySelectorAll(".ship"),o=document.querySelectorAll(".block");r.forEach((e=>{e.addEventListener("click",(()=>{"column"!==e.style.flexDirection?e.style.flexDirection="column":e.style.flexDirection="row"}))})),r.forEach((e=>{e.addEventListener("dragstart",(()=>{console.log("dragging"),"column"===e.style.flexDirection&&(i="column")}))})),document.addEventListener("dragstart",(t=>{e=t.target.getAttribute("Id")})),o.forEach((l=>{l.addEventListener("dragover",(o=>{if(o.preventDefault(),s=t[e].size,r=t.shipId,!n){let e=l;for(let t=0;t<s;t++)if("column"===i){for(let t=0;t<10;t++)e=e.nextElementSibling;e.classList.add("hovered")}else e.classList.add("hovered"),e=e.nextElementSibling;n=!0}}))})),o.forEach((e=>{e.addEventListener("dragleave",(()=>{n=!1;let t=e;for(let e=0;e<s;e++)if("column"===i)for(let e=0;e<10;e++)t.classList.remove("hovered"),t=t.nextElementSibling;else t.classList.remove("hovered"),t=t.nextElementSibling}))})),o.forEach((n=>{n.addEventListener("drop",(()=>{s=t[e].size,l=t[e].id,console.log("dropped"),console.log(s);let i=n;for(let e=0;e<s;e++)i.classList.add("selected"),i.classList.add(l),i.classList.remove("hovered"),i=i.nextElementSibling}))}))})),document.addEventListener("gameboardReady",(()=>{let e=document.getElementById("start"),s=document.getElementById("reset"),n=document.getElementById("enemyBoard");function i(){return Math.floor(100*Math.random())+0}function l(e){let s=n.firstElementChild,r=i();for(let e=0;e<r;e++)s=s.nextElementSibling;let o=function(e,s){let n;for(let i=0;i<t[e].size;i++){if(s.classList.contains("selected")){n=!1;break}if(!s.nextElementSibling){n=!1;break}for(let e=0;e<10;e++){if(!s.nextElementSibling){n=!1;break}s=s.nextElementSibling,n=!0}}return n}(e,s);if(o)for(let n=0;n<t[e].size&&(s.classList.add("selected"),s.classList.add(e),n!=t[e].size-1);n++)for(let e=0;e<10;e++)s=s.nextElementSibling;else l(e)}function r(e){let s=i(),l=n.firstElementChild;for(let e=0;e<s;e++)l=l.nextElementSibling;let o=function(e,s,n){let i=!0;for(let n=0;n<t[e].size;n++){if(s.classList.contains("selected")){i=!1;break}let e=Array.from(s.classList),t=s.nextElementSibling;if(!t){i=!1;break}{let l=Array.from(t.classList);if(e[n]!==l[n]){i=!1;break}s=t}}return i}(e,l);if(o)for(let s=0;s<t[e].size;s++)l.classList.add("selected"),l.classList.add(e),l=l.nextElementSibling;else r(e)}function o(e){"horizontal"===function(){let e;return e=Math.floor(100*Math.random())+0<=50?"vertical":"horizontal",e}()?r(e):l(e)}s.addEventListener("click",(()=>{n.querySelectorAll("div").forEach((e=>{e.classList.remove("selected"),e.classList.remove("EnemyCarrier"),e.classList.remove("EnemySubmarine"),e.classList.remove("EnemyDestroyer"),e.classList.remove("EnemyCruiser"),e.classList.remove("EnemyBattleShip")}))})),e.addEventListener("click",(()=>{o("EnemyCarrier"),setTimeout(o("EnemyBattleShip"),10),setTimeout(o("EnemyCruiser"),10),setTimeout(o("EnemySubmarine"),10),setTimeout(o("EnemyDestroyer"),10)}))})),document.addEventListener("gameboardReady",(()=>{!function(){document.getElementById("enemyBoard");let e,t=document.getElementById("playerBoard"),s=document.querySelectorAll(".eBlock"),n=document.querySelectorAll(".block"),i=0,l=0,r=0,o=0,a=0;function c(e,s){e=t.firstElementChild;for(let t=0;t<100;t++)e.classList.contains(s)&&(e.classList.remove(s),e.classList.remove("selected"),e.classList.remove("hit"),e.classList.add("Destroyed")),e=e.nextElementSibling}s.forEach((t=>{t.addEventListener("click",(()=>{t.classList.contains("selected")?t.classList.add("hit"):t.classList.add("missed"),e=n}))})),n.forEach((t=>{t.addEventListener("click",(()=>{t.classList.contains("selected")?(t.classList.add("hit"),e=t,function(e){e.classList.contains("Carrier")?(i++,console.log(i)):e.classList.contains("BattleShip")?(l++,console.log(l)):e.classList.contains("Cruiser")?(r++,console.log(r)):e.classList.contains("Submarine")?(o++,console.log(o)):e.classList.contains("Destroyer")&&(a++,console.log(a))}(e)):t.classList.add("missed"),function(t,s,n,i,l){5==t&&(c(e,"Carrier"),alert("Works")),4==s&&c(e,"BattleShip"),3==n&&c(e,"Cruiser"),3==i&&c(e,"Submarine"),2==l&&c(e,"Destroyer")}(i,l,r,o,a)}))}))}()})),new class{constructor(){this.board=this.generateDomBoard(),document.dispatchEvent(new Event("gameboardReady"))}generateDomBoard(){let e=document.getElementById("playerBoard"),t=document.getElementById("enemyBoard");for(let s=0;s<10;s++)for(let n=0;n<10;n++){let n=document.createElement("div"),i=document.createElement("div");e.appendChild(n),t.appendChild(i),n.classList="block",i.classList="eBlock";let l=this.zoneName(s);n.classList.add(l),i.classList.add(l)}}zoneName(e){let t;return 0==e&&(t="A"),1==e&&(t="B"),2==e&&(t="C"),3==e&&(t="D"),4==e&&(t="E"),5==e&&(t="F"),6==e&&(t="G"),7==e&&(t="H"),8==e&&(t="I"),9==e&&(t="J"),t}}})();