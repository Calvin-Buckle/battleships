(()=>{"use strict";const e=class{constructor(e){this.hits=[],this.size=e}hit(e){return this.hits.push(e)}isSunk(){return this.position.every((e=>this.hits.includes(e)))}isHit(){return this.hits.some((e=>this.position.includes(e)))}},t={Carrier:new e(5),BattleShip:new e(4),Cruiser:new e(3),Submarine:new e(3),Destroyer:new e(2),EnemyCarrier:new e(5),EnemyBattleShip:new e(4),EnemyCruiser:new e(3),EnemySubmarine:new e(3),EnemyDestroyer:new e(2)};document.addEventListener("gameboardReady",(()=>{document.getElementById("playerBoard");let e,n,s,l,i=document.querySelectorAll(".ship"),r=document.querySelectorAll(".block");i.forEach((e=>{e.addEventListener("click",(()=>{"column"!==e.style.flexDirection?e.style.flexDirection="column":e.style.flexDirection="row"}))})),i.forEach((e=>{e.addEventListener("dragstart",(()=>{console.log("dragging"),"column"===e.style.flexDirection&&(l="column")}))})),document.addEventListener("dragstart",(t=>{e=t.target.getAttribute("Id")})),r.forEach((r=>{r.addEventListener("dragover",(o=>{if(o.preventDefault(),n=t[e].size,i=t.shipId,!s){let e=r;for(let t=0;t<n;t++)if("column"===l){for(let t=0;t<10;t++)e=e.nextElementSibling;e.classList.add("hovered")}else e.classList.add("hovered"),e=e.nextElementSibling;s=!0}}))})),r.forEach((e=>{e.addEventListener("dragleave",(()=>{s=!1;let t=e;for(let e=0;e<n;e++)if("column"===l)for(let e=0;e<10;e++)t.classList.remove("hovered"),t=t.nextElementSibling;else t.classList.remove("hovered"),t=t.nextElementSibling}))})),r.forEach((s=>{s.addEventListener("drop",(()=>{n=t[e].size,console.log("dropped"),console.log(n);let l=s;for(let e=0;e<n;e++)l.classList.add("selected"),l.classList.remove("hovered"),l=l.nextElementSibling}))}))})),document.addEventListener("gameboardReady",(()=>{let e=document.getElementById("start"),n=document.getElementById("reset"),s=document.getElementById("enemyBoard");function l(){return Math.floor(100*Math.random())+0}function i(e){let n=s.firstElementChild,r=l();for(let e=0;e<r;e++)n=n.nextElementSibling;let o=function(e,n){let s;for(let l=0;l<t[e].size;l++){if(n.classList.contains("selected")){s=!1;break}if(!n.nextElementSibling){s=!1;break}for(let e=0;e<10;e++){if(!n.nextElementSibling){s=!1;break}n=n.nextElementSibling,s=!0}}return s}(e,n);if(o)for(let s=0;s<t[e].size&&(n.classList.add("selected"),n.classList.add(e),s!=t[e].size-1);s++)for(let e=0;e<10;e++)n=n.nextElementSibling;else i(e)}function r(e){let n=l(),i=s.firstElementChild;for(let e=0;e<n;e++)i=i.nextElementSibling;let o=function(e,n,s){let l=!0;for(let s=0;s<t[e].size;s++){if(n.classList.contains("selected")){l=!1;break}let e=Array.from(n.classList),t=n.nextElementSibling;if(!t){l=!1;break}{let i=Array.from(t.classList);if(e[s]!==i[s]){l=!1;break}n=t}}return l}(e,i);if(o)for(let n=0;n<t[e].size;n++)i.classList.add("selected"),i.classList.add(e),i=i.nextElementSibling;else r(e)}function o(e){"horizontal"===function(){let e;return e=Math.floor(100*Math.random())+0<=50?"vertical":"horizontal",e}()?r(e):i(e)}n.addEventListener("click",(()=>{s.querySelectorAll("div").forEach((e=>{e.classList.remove("selected"),e.classList.remove("EnemyCarrier"),e.classList.remove("EnemySubmarine"),e.classList.remove("EnemyDestroyer"),e.classList.remove("EnemyCruiser"),e.classList.remove("EnemyBattleShip")}))})),e.addEventListener("click",(()=>{o("EnemyCarrier"),setTimeout(o("EnemyBattleShip"),10),setTimeout(o("EnemyCruiser"),10),setTimeout(o("EnemySubmarine"),10),setTimeout(o("EnemyDestroyer"),10)}))})),document.addEventListener("gameboardReady",(()=>{!function(){document.getElementById("enemyBoard"),document.getElementById("playerBoard");let e=document.querySelectorAll(".eBlock"),t=document.querySelectorAll(".block");e.forEach((e=>{e.addEventListener("click",(()=>{e.classList.contains("selected")?e.classList.add("hit"):e.classList.add("missed")}))})),t.forEach((e=>{e.addEventListener("click",(()=>{e.classList.contains("selected")?e.classList.add("hit"):e.classList.add("missed")}))}))}()})),new class{constructor(){this.board=this.generateDomBoard(),document.dispatchEvent(new Event("gameboardReady"))}generateDomBoard(){let e=document.getElementById("playerBoard"),t=document.getElementById("enemyBoard");for(let n=0;n<10;n++)for(let s=0;s<10;s++){let s=document.createElement("div"),l=document.createElement("div");e.appendChild(s),t.appendChild(l),s.classList="block",l.classList="eBlock";let i=this.zoneName(n);s.classList.add(i),l.classList.add(i)}}zoneName(e){let t;return 0==e&&(t="A"),1==e&&(t="B"),2==e&&(t="C"),3==e&&(t="D"),4==e&&(t="E"),5==e&&(t="F"),6==e&&(t="G"),7==e&&(t="H"),8==e&&(t="I"),9==e&&(t="J"),t}}})();